<html>
    <head>
        <title>joshwnj / public wiki</title>
        <link href="../theme/main.css" type="text/css" rel="stylesheet">
    </head>
    <body>
        <header>
            <div class="inner">
                <a href="/topics/">topics</a>
            </div>
        </header>

        <div class="topic"><section><div class="section-content"><h1>Variations on a structure</h1>
<p>There is a common problem in javascript where you have to convert a data structure from one form to another. However it&#x27;s complicated as you often run out of names.</p>
<p>eg. <code>var foo = { a: [1,2,3] }</code> is known as a &quot;foo&quot; object. And we have a function that expects a &quot;foo&quot; object.</p>
<p>But what if we, for some reason have something that is <em>almost</em> a foo object: <code>var foo = { a: &#x27;1,2,3&#x27; }</code>.
We could just convert inline like <code>foo.a = foo.a.split(&#x27;,&#x27;)</code>. But if this is a common conversion we will have a lot of duplicated logic and will quickly lead to confusion.</p>
<p>To me this is a naming problem. If we had a system of saying this is a <code>foo</code>, <code>foo_1</code>, or <code>foo_N</code> we could define more descriptively what those variations entail. And provide functions to convert from <code>foo_1 -&gt; foo</code>.</p>
<p>Then it becomes possible to make a rule where structures are only ever converted from one form to another via a function.  And to put in checks to say &quot;i expect this object to be of this particular form&quot;</p>
<p>First step is to define the &quot;natural&quot; structure. So in js that means date objects for dates, arrays for lists and ints / floats for number values.</p>
<p>Now say we fetch an object over a json api. Most things should be in their natural structure, except for date objects. So the api gives us a <code>foo1</code> and we have to convert that to <code>foo</code>.</p>
<p>Now we want to populate an edit-form with the object. Date objects are still fine, but arrays need to be serialized to comma-separated strings. And maybe some nested objects need to be flatten. So this will be <code>foo -&gt; foo2</code>.</p>
<p>When the form is submitted we just need a function <code>foo2 -&gt; foo</code> and then we can also have a <code>foo -&gt; foo1</code> to send back to the api.</p>
</div></section><div class="incoming-links"><h2>Incoming Links</h2><ul><li><a href="./ideas.html">ideas</a></li></ul></div></div>

        <footer>
            <div class="inner">
                <a href="https://twitter.com/joshwnj" target="_blank">&rarr; get in touch</a>
            </div>
        </footer>
</html>
